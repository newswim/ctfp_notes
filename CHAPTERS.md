#### Preface (xiii)

## Part One (3)

#### 1 Category: The Essence of Composition
- 1.1 Arrows as Functions (3)
- 1.2 Properties of Composition (6)
- 1.3 Composition is the Essence of Programming (9)
- 1.4 Challenges (11)

#### 2 Types and Functions 13
- 2.1 Who Needs Types? . . . . . . . . . . . . (13)
- 2.2 Types Are About Composability. . . . . . (14)
- 2.3 What Are Types?. . . . . . . . . . . . . (16)
- 2.4 Why Do We Need a Mathematical Model? . . (19)
- 2.5 Pure and Dirty Functions . . . . . . . . (22)
- 2.6 Examples of Types. . . . . . . . . . . . (22)
- 2.7 Challenges . . . . . . . . . . . . . . . (26)

#### 3 Categories Great and Small 29
- 3.1 No Objects......................... (29)
- 3.2 Simple Graphs....................... (30)
- 3.3 Orders ........................... (30)
- 3.4 Monoid as Set ....................... (31)
- 3.5 Monoid as Category.................... (36)
- 3.6 Challenges......................... (38)

#### 4 Kleisli Categories 41
- 4.1 The Writer Category ................... (46)
- 4.2 Writer in Haskell ..................... (49)
- 4.3 Kleisli Categories ..................... (52)
- 4.4 Challenge ......................... (53)

#### 5 Products and Coproducts 55
- 5.1 Initial Object........................ (56)
- 5.2 Terminal Object ...................... (58)
- 5.3 Duality........................... (59)
- 5.4 Isomorphisms ....................... (60)
- 5.5 Products .......................... (62)
- 5.6 Coproduct ......................... (68)
- 5.7 Asymmetry ........................ (72)
- 5.8 Challenges...... ................... (74)
- 5.9 Bibliography . . . . . ................... (75)

#### 6 Simple Algebraic Data Types 77
- 6.1 Product Types ....................... (78)
- 6.2 Records........................... (82)
- 6.3 SumTypes......................... (83)
- 6.4 Algebraof Types ..................... (87)
- 6.5 Challenges......................... (92)

#### 7 Functors 93
- 7.1 Functors in Programming................. (96)
- - 7.1.1 The Maybe Functor................ (96)
- - 7.1.2 Equational Reasoning .............. (98)
- - 7.1.3 Optional...................... (101)
- - 7.1.4 Type classes .................... (103)
- - 7.1.5 Functor in C++ .................. (105)
- - 7.1.6 The List Functor ................. (106)
- - 7.1.7 The Reader Functor................ (108)
- 7.2 Functors as Containers .................. (110)
- 7.3 Functor Composition ................... (113)
- 7.4 Challenges......................... (115)

#### 8 Functoriality 117
- 8.1 Bifunctors ......................... 117
- 8.2 Product and Coproduct Bifunctors. . . . . . . . . . . . 120
- 8.3 Functorial Algebraic Data Types . . . . . . . . . . . . . 122
- 8.4 Functors in C++...................... 126
- 8.5 The Writer Functor .................... 128
- 8.6 Covariant and Contravariant Functors . . . . . . . . . 130
- 8.7 Profunctors......................... 134
- 8.8 Challenges......................... 135

#### 9 Function Types 139
- 9.1 Universal Construction.................. 140
- 9.2 Currying.......................... 145
- 9.3 Exponentials........................ 149
- 9.4 Cartesian Closed Categories ............... 150
- 9.5 Exponentials and Algebraic Data Types . . . . . . . . . 151
- - 9.5.1 Zeroth Power................... 152
- - 9.5.2 Powers of One .................. 152
- - 9.5.3 First Power .................... 153
- - 9.5.4 Exponentials of Sums .............. 153
- - 9.5.5 Exponentials of Exponentials . . . . . . . . . . 154
- - 9.5.6 Exponentials over Products . . . . . . . . . . . 154
- 9.6 Curry-HowardIsomorphism............... 154
- 9.7 Bibliography........................ 158


#### 10 Natural Transformations 159
- 10.1 Polymorphic Functions.................. 164
- 10.2 Beyond Naturality..................... 170
- 10.3 Functor Category ..................... 171
- 10.4 2-Categories ........................ 175
- 10.5 Conclusion......................... 180
- 10.6 Challenges......................... 181

## Part Two

#### 11 Declarative Programming (185)

#### 12 Limits and Colimits (193)
- 12.1 Limit as a Natural Isomorphism . . . . . . . . . . . . . 199
- 12.2 Examples of Limits .................... 204
- 12.3 Colimits .......................... 211
- 12.4 Continuity ......................... 213
- 12.5 Challenges......................... 215

#### 13 Free Monoids (217)
- 13.1 Free Monoid in Haskell.................. 219
- 13.2 Free Monoid Universal Construction . . . . . . . . . . 220
- 13.3 Challenges......................... 225

#### 14 Representable Functors (227)
- 14.1 The Hom Functor ..................... 229
- 14.2 Representable Functors.................. 232
- 14.3 Challenges......................... 237
- 14.4 Bibliography........................ 237

#### 15 The Yoneda Lemma (239)
- 15.1 Yoneda in Haskell..................... 247
- 15.2 Co-Yoneda ......................... 249
- 15.3 Challenges......................... 250
- 15.4 Bibliography........................ 250

#### 16 Yoneda Embedding (251)
- 16.1 The Embedding ...................... 254
- 16.2 Application to Haskell .................. 255
- 16.3 Preorder Example..................... 256
- 16.4 Naturality ......................... 258
- 16.5 Challenges......................... 259

## Part Three

#### 17 It‚Äôs All About Morphisms (263)
- 17.1 Functors .......................... 263
- 17.2 Commuting Diagrams................... 264
- 17.3 Natural Transformations ................. 265
- 17.4 Natural Isomorphisms................... 267
- 17.5 Hom-Sets.......................... 267
- 17.6 Hom-Set Isomorphisms.................. 268
- 17.7 Asymmetry of Hom-Sets ................. 269
- 17.8 Challenges......................... 270

#### 18 Adjunctions (271)
- 18.1 Adjunction and Unit/Counit Pair . . . . . . . . . . . . 272
- 18.2 Adjunctions and Hom-Sets................ 278
- 18.3 Product from Adjunction................. 282
- 18.4 Exponential from Adjunction .............. 287
- 18.5 Challenges......................... 289

#### 19 Free/Forgetful Adjunctions (291)
- 19.1 Some Intuitions ...................... 295
- 19.2 Challenges......................... 298

#### 20 Monads: Programmer‚Äôs Definition 299
- 20.1 The Kleisli Category.................... 301
- 20.2 Fish Anatomy ....................... 304
- 20.3 The do Notation ...................... 306

#### 21 Monads and Effects (311)
- 21.1 The Problem ........................ 311
- 21.2 The Solution ........................ 313
- - 21.2.1 Partiality ..................... 313
- - 21.2.2 Nondeterminism ................. 314
- - 21.2.3 Read-Only State ................. 317
- - 21.2.4 Write-Only State ................. 318
- - 21.2.5 State........................ 319
- - 21.2.6 Exceptions..................... 320
- - 21.2.7 Continuations................... 321
- - 21.2.8 Interactive Input ................. 323
- - 21.2.9 Interactive Output ................ 326
- 21.3 Conclusion......................... 327

#### 22 Monads Categorically (329)
- 22.1 Monoidal Categories ................... 335
- 22.2 Monoid in a Monoidal Category............. 340
- 22.3 Monads as Monoids.................... 341
- 22.4 Monads from Adjunctions ................ 344

#### 23 Comonads (349)
- 23.1 Programming with Comonads.............. 350
- 23.2 The Product Comonad .................. 351
- 23.3 Dissecting the Composition ............... 352
- 23.4 The Stream Comonad................... 355
- 23.5 Comonad Categorically.................. 357
- 23.6 The Store Comonad.................... 359
- 23.7 Challenges......................... 362

#### 24 F-Algebras (363)
- 24.1 Recursion.......................... 367
- 24.2 Categoryof F-Algebras.................. 369
- 24.3 Natural Numbers ..................... 373
- 24.4 Catamorphisms ...................... 374
- 24.5 Folds ............................ 376
- 24.6 Coalgebras......................... 377
- 24.7 Challenges......................... 381

#### 25 Algebras for Monads (383)
- 25.1 T-algebras ......................... 386
- 25.2 The Kleisli Category.................... 390
- 25.3 Coalgebras for Comonads ................ 392
- 25.4 Lenses ........................... 393
- 25.5 Challenges......................... 395

#### 26 Ends and Coends (397)
- 26.1 Dinatural Transformations................ 399
- 26.2 Ends ............................ 401
- 26.3 Ends as Equalizers..................... 404
- 26.4 Natural Transformations as Ends . . . . . . . . . . . . 405
- 26.5 Coends........................... 407
- 26.6 Ninja Yoneda Lemma ................... 410
- 26.7 Profunctor Composition ................. 412

#### 27 Kan Extensions (415)
- 27.1 Right Kan Extension ................... 418
- 27.2 Kan Extension as Adjunction............... 420
- 27.3 Left Kan Extension .................... 422
- 27.4 Kan Extensions as Ends.................. 425
- 27.5 Kan Extensions in Haskell ................ 429
- 27.6 Free Functor........................ 432

#### 28 Enriched Categories (435)
- 28.1 Why Monoidal Category? ................ 436
- 28.2 Monoidal Category .................... 437
- 28.3 Enriched Category .................... 440
- 28.4 Preorders.......................... 442
- 28.5 Metric Spaces ....................... 443
- 28.6 Enriched Functors..................... 444
- 28.7 Self Enrichment ...................... 445
- 28.8 Relation to ùüê-Categories ................. 447

#### 29 Topoi (449)
- 29.1 Subobject Classifier .................... 450
- 29.2 Topos............................ 455
- 29.3 Topoi and Logic ...................... 456
- 29.4 Challenges......................... 457

#### 30 Lawvere  eories (459)
- 30.1 Universal Algebra..................... 459
- 30.2 Lawvere Theories ..................... 461
- 30.3 Models of Lawvere Theories ............... 465
- 30.4 The Theory of Monoids.................. 467
- 30.5 Lawvere Theories and Monads.............. 468
- 30.6 Monads as Coends..................... 471
- 30.7 Lawvere Theory of Side Effects.............. 475
- 30.8 Challenges......................... 477
- 30.9 FurtherReading...................... 477

#### 31 Monads, Monoids, and Categories (479)
- 31.1 Bicategories ........................ 480
- 31.2 Monads........................... 485
- 31.3 Challenges......................... 490
- 31.4 Bibliography........................ 490

#### Index (491)
#### Acknowledgments (495)
#### Colophon (497)
#### Copyleft notice (499)
